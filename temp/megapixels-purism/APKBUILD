# Purism's fork of megapixels, for the Librem 5
pkgname=megapixels-purism
pkgver=0.18.0
pkgrel=0
pkgdesc="GTK+3 camera app for mobile devices"
url="https://source.puri.sm/Librem5/megapixels"
arch="all"
license="GPL-3.0-only"
# Required by postprocess.sh
# depends="cmd:dcraw_emu cmd:convert cmd:exiftool"
depends="
	exiftool
	graphicsmagick
	i2c-tools
	libraw-tools
	"
makedepends="
	glib-dev
	gtk+3.0-dev
	libbsd-dev
	libcamera-dev
	rust
	tiff-dev meson zbar-dev
	"
source="https://source.puri.sm/Librem5/megapixels/-/archive/v$pkgver/megapixels-v$pkgver.tar.gz
		10_megapixels.sudoers"
options="!check" # There's no testsuite
provides="megapixels=$pkgver"
builddir="$srcdir/megapixels-v$pkgver"

build() {
	abuild-meson . output
	meson compile ${JOBS:+-j ${JOBS}} -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
	install -Dm644 "$srcdir"/10_megapixels.sudoers "$pkgdir"/etc/sudoers.d/10_megapixels
}

sha512sums="
6198c7dc735e5223ae5a34007168e3f9c0d5db720ba09f5af3adb67677962c61a30dff44331ecf28207dda4b3a5dec1312fa76adc153b27410128678e88d205d  megapixels-v0.18.0.tar.gz
b7d8f25be0ae1f954c49727476952831019bcc443a66c4b39f7421c257aa5c310ad82390746768c3432727a0688a1174565cab5a48997092f79622cedb703cec  10_megapixels.sudoers
"
